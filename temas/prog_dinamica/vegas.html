<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juego de Apuestas</title>

</head>
<body>
    <div class="hero">
        <h1>Juego de Apuestas</h1>
    </div>
    <div class="container">
        <form id="apuestaForm">
            <br><label for="fichas_iniciales">Fichas iniciales:</label>
            <input type="number" id="fichas_iniciales" min="1" value="3" required>

            <br><label for="jugadas">Número de jugadas:</label>
            <input type="number" id="jugadas" min="1" value="3" required>

            <br><label for="prob_ganar">Probabilidad de ganar (entre 0 y 1):</label>
            <input type="number" id="prob_ganar" min="0" max="1" step="0.01" value="0.67" required>

            <button type="button" onclick="calcularPolitica()">Calcular</button>
        </form>

        <div id="resultado" class="result" style="display: none;">
            <h2>Resultado</h2>
            <p id="probOptima"></p>
            <p id="politica"></p>
        </div>
    </div>

    <script>
        function calcularPolitica() {
    const fichasIniciales = parseInt(document.getElementById("fichas_iniciales").value);
    const jugadas = parseInt(document.getElementById("jugadas").value);
    const probGanar = parseFloat(document.getElementById("prob_ganar").value);

    if (isNaN(fichasIniciales) || fichasIniciales < 1 || 
        isNaN(jugadas) || jugadas < 1 || 
        isNaN(probGanar) || probGanar < 0 || probGanar > 1) {
        alert("Por favor, ingrese valores válidos.");
        return;
    }

    const resultado = politicaOptima(fichasIniciales, jugadas, probGanar);
    document.getElementById("probOptima").innerText = `Probabilidad óptima de ganar: ${resultado.probOptima.toFixed(4)}`;
    document.getElementById("politica").innerText = `Política óptima de apuestas: ${resultado.politica.join(", ")}`;
    document.getElementById("resultado").style.display = "block";
}

function politicaOptima(fichasIniciales, jugadas, probGanar) {
    const dp = Array.from({ length: 9 }, () => Array(jugadas + 1).fill(0));

    for (let i = 5; i < 9; i++) dp[i][0] = 1;

    for (let jugada = 1; jugada <= jugadas; jugada++) {
        for (let fichas = 0; fichas < 9; fichas++) {
            let mejorProb = dp[fichas][jugada - 1];

            for (let apuesta = 1; apuesta <= fichas; apuesta++) {
                const probGanarJugada = probGanar * dp[Math.min(fichas + apuesta, 8)][jugada - 1] +
                                        (1 - probGanar) * dp[Math.max(fichas - apuesta, 0)][jugada - 1];
                mejorProb = Math.max(mejorProb, probGanarJugada);
            }

            dp[fichas][jugada] = mejorProb;
        }
    }

    let politica = [];
    let fichas = fichasIniciales;
    for (let jugada = jugadas; jugada > 0; jugada--) {
        let mejorApuesta = 0;
        let mejorProb = dp[fichas][jugada - 1];

        for (let apuesta = 1; apuesta <= fichas; apuesta++) {
            const probGanarJugada = probGanar * dp[Math.min(fichas + apuesta, 8)][jugada - 1] +
                                    (1 - probGanar) * dp[Math.max(fichas - apuesta, 0)][jugada - 1];
            if (probGanarJugada > mejorProb) {
                mejorProb = probGanarJugada;
                mejorApuesta = apuesta;
            }
        }

        politica.push(mejorApuesta);
        fichas += probGanar > 0.5 ? mejorApuesta : -mejorApuesta; // Actualización aproximada
    }

    return {
        probOptima: dp[fichasIniciales][jugadas],
        politica: politica.reverse()
    };
}

    </script>
</body>
</html>
